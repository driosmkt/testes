<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Maple Bear Dashboard - Leads e Matr√≠culas</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/babel-standalone@7.22.10/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    // Dados simulados (substituir por integra√ß√£o com API do n8n)
    const initialData = {
      leads: [
        { id: 1, name: "Ana Silva", email: "ana@example.com", status: "Novo", unit: "Petrolina", date: "2025-09-01" },
        { id: 2, name: "Jo√£o Santos", email: "joao@example.com", status: "Qualificado", unit: "Petrolina", date: "2025-09-02" },
        { id: 3, name: "Maria Oliveira", email: "maria@example.com", status: "N√£o Qualificado", unit: "Petrolina", date: "2025-09-03" },
      ],
      enrollments: [
        { id: 1, name: "Ana Silva", status: "Confirmada", unit: "Petrolina", date: "2025-09-04" },
        { id: 2, name: "Jo√£o Santos", status: "Pendente", unit: "Petrolina", date: "2025-09-04" },
      ],
      appointments: [
        { id: 1, name: "Ana Silva", date: "2025-09-05 10:00", unit: "Petrolina", status: "Agendado" },
        { id: 2, name: "Jo√£o Santos", date: "2025-09-06 14:00", unit: "Petrolina", status: "Agendado" },
      ],
    };

    // Componente de Card para m√©tricas
    const MetricCard = ({ title, value, emoji }) => (
      <div className="bg-white p-4 rounded-lg shadow-md flex items-center">
        <span className="text-2xl mr-2">{emoji}</span>
        <div>
          <h3 className="text-lg font-semibold text-gray-700">{title}</h3>
          <p className="text-2xl font-bold text-blue-600">{value}</p>
        </div>
      </div>
    );

    // Componente de Tabela para listagem
    const DataTable = ({ title, data, columns }) => (
      <div className="mt-6">
        <h2 className="text-xl font-bold text-gray-800 mb-4">{title}</h2>
        <div className="overflow-x-auto">
          <table className="w-full bg-white rounded-lg shadow-md">
            <thead>
              <tr className="bg-blue-100 text-left">
                {columns.map((col, index) => (
                  <th key={index} className="p-3 text-gray-700">{col}</th>
                ))}
              </tr>
            </thead>
            <tbody>
              {data.map((item, index) => (
                <tr key={index} className="border-t">
                  {Object.values(item).map((value, i) => (
                    <td key={i} className="p-3 text-gray-600">{value}</td>
                  ))}
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>
    );

    // Componente de Filtro
    const Filter = ({ units, onUnitChange, onDateChange }) => (
      <div className="flex space-x-4 mb-6">
        <select
          className="p-2 border rounded-lg"
          onChange={(e) => onUnitChange(e.target.value)}
        >
          <option value="">Todas as Unidades</option>
          {units.map((unit, index) => (
            <option key={index} value={unit}>{unit}</option>
          ))}
        </select>
        <input
          type="date"
          className="p-2 border rounded-lg"
          onChange={(e) => onDateChange(e.target.value)}
        />
      </div>
    );

    // Componente Principal
    const App = () => {
      const [leads, setLeads] = React.useState(initialData.leads);
      const [enrollments, setEnrollments] = React.useState(initialData.enrollments);
      const [appointments, setAppointments] = React.useState(initialData.appointments);
      const [selectedUnit, setSelectedUnit] = React.useState("");
      const [selectedDate, setSelectedDate] = React.useState("");

      // Filtrar dados com base na unidade e data
      const filterData = (data) => {
        return data.filter((item) => {
          const matchesUnit = selectedUnit ? item.unit === selectedUnit : true;
          const matchesDate = selectedDate ? item.date.startsWith(selectedDate) : true;
          return matchesUnit && matchesDate;
        });
      };

      const filteredLeads = filterData(leads);
      const filteredEnrollments = filterData(enrollments);
      const filteredAppointments = filterData(appointments);

      const units = [...new Set([...leads, ...enrollments, ...appointments].map(item => item.unit))];

      return (
        <div className="container mx-auto p-6">
          <h1 className="text-3xl font-bold text-blue-800 mb-6">
            üçÅ Maple Bear Dashboard üìö‚ú®
          </h1>
          
          {/* Filtros */}
          <Filter
            units={units}
            onUnitChange={setSelectedUnit}
            onDateChange={setSelectedDate}
          />

          {/* M√©tricas */}
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
            <MetricCard title="Leads Totais" value={filteredLeads.length} emoji="üìä" />
            <MetricCard title="Matr√≠culas Confirmadas" value={filteredEnrollments.filter(e => e.status === "Confirmada").length} emoji="üéâ" />
            <MetricCard title="Agendamentos" value={filteredAppointments.length} emoji="üóìÔ∏è" />
          </div>

          {/* Tabelas */}
          <DataTable
            title="Leads üçÅ"
            data={filteredLeads.map(({ id, name, email, status, unit, date }) => ({ ID: id, Nome: name, Email: email, Status: status, Unidade: unit, Data: date }))}
            columns={["ID", "Nome", "Email", "Status", "Unidade", "Data"]}
          />
          <DataTable
            title="Matr√≠culas üêª"
            data={filteredEnrollments.map(({ id, name, status, unit, date }) => ({ ID: id, Nome: name, Status: status, Unidade: unit, Data: date }))}
            columns={["ID", "Nome", "Status", "Unidade", "Data"]}
          />
          <DataTable
            title="Agendamentos üìö"
            data={filteredAppointments.map(({ id, name, date, unit, status }) => ({ ID: id, Nome: name, Data: date, Unidade: unit, Status: status }))}
            columns={["ID", "Nome", "Data", "Unidade", "Status"]}
          />
        </div>
      );
    };

    // Renderizar o aplicativo
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
